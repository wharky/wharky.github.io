name: Daily Blog Update

on:
  schedule:
    # 한국 시간 21:00 (UTC 12:00) 실행
    - cron: '0 12 * * *'

  # 수동 실행 버튼 (테스트용)
  workflow_dispatch:

permissions:
  contents: write

jobs:
  update-blog:
    runs-on: ubuntu-latest

    steps:
      # (1) 소스 코드 체크아웃
      - name: Checkout
        uses: actions/checkout@v4

      # (2) JDK 17 설정
      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'

      # (3) Java 코드 실행 (핵심)
      - name: Run Java Generator
        run: java generator/src/main/java/BlogPoster.java

      # (4) 변경사항 커밋 및 푸시
      - name: Commit and Push changes
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'
          git add .
          git commit -m "Auto-post: Daily log update" || echo "No changes to commit"
          git push